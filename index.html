<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Test</title>
        <style>
            .spacer {
                padding: 0;
                margin: 0;
                border: none;
                visibility: hidden;
            }
            #SuTable {
                border-collapse:separate;
                border-spacing: 3px;
            }
            #SelTable {
                border-collapse:separate;
                border-spacing: 1px;
            }
            #SuTable td {
                width: 32px;
                height: 32px;
                border: 1px solid black;
                text-align: center;
                font-size: 26px;
                cursor: pointer;
                color: rgb(27, 92, 213);
            }
            #h1, #h2, #h3, #h4, #h5, #h6, #h7, #h8, #h9{
                width: 31px;
                height: 31px;
                border: 1px solid black;
                text-align: center;
                font-size: 24px;
                cursor: pointer;
            }
            #Run, #ClearTable, #Hclr{
                width: 31px;
                height: 31px;
                border: 1px solid black;
                text-align: center;
                font-size: 24px;
                cursor: pointer;
            }
            .active {
                background-color: rgb(183, 214, 255);
            }
            .correct {
                background-color:rgb(223, 255, 209);
            }
            .wrong {
                background-color:rgb(255, 221, 221);
            }
            
        </style>
    </head>
    <body>
        <table id="SuTable">
            <tr><td id ="t11"></td><td id ="t12"></td><td id ="t13"></td><td class="spacer" style="width: 1px;"></td><td id ="t14"></td><td id ="t15"></td><td id ="t16"><td class="spacer" style="width: 1px;"></td></td><td id ="t17"></td><td id ="t18"></td><td id ="t19"></td></tr>
            <tr><td id ="t21"></td><td id ="t22"></td><td id ="t23"></td><td class="spacer" style="width: 1px;"></td><td id ="t24"></td><td id ="t25"></td><td id ="t26"><td class="spacer" style="width: 1px;"></td></td><td id ="t27"></td><td id ="t28"></td><td id ="t29"></td></tr>
            <tr><td id ="t31"></td><td id ="t32"></td><td id ="t33"></td><td class="spacer" style="width: 1px;"></td><td id ="t34"></td><td id ="t35"></td><td id ="t36"><td class="spacer" style="width: 1px;"></td></td><td id ="t37"></td><td id ="t38"></td><td id ="t39"></td></tr>
            <tr><td class="spacer" colspan="9" style="height: 1px;"></td></tr>
            <tr><td id ="t41"></td><td id ="t42"></td><td id ="t43"></td><td class="spacer" style="width: 1px;"></td><td id ="t44"></td><td id ="t45"></td><td id ="t46"><td class="spacer" style="width: 1px;"></td></td><td id ="t47"></td><td id ="t48"></td><td id ="t49"></td></tr>
            <tr><td id ="t51"></td><td id ="t52"></td><td id ="t53"></td><td class="spacer" style="width: 1px;"></td><td id ="t54"></td><td id ="t55"></td><td id ="t56"><td class="spacer" style="width: 1px;"></td></td><td id ="t57"></td><td id ="t58"></td><td id ="t59"></td></tr>
            <tr><td id ="t61"></td><td id ="t62"></td><td id ="t63"></td><td class="spacer" style="width: 1px;"></td><td id ="t64"></td><td id ="t65"></td><td id ="t66"><td class="spacer" style="width: 1px;"></td></td><td id ="t67"></td><td id ="t68"></td><td id ="t69"></td></tr>
            <tr><td class="spacer" colspan="9" style="height: 1px;"></td></tr>
            <tr><td id ="t71"></td><td id ="t72"></td><td id ="t73"></td><td class="spacer" style="width: 1px;"></td><td id ="t74"></td><td id ="t75"></td><td id ="t76"><td class="spacer" style="width: 1px;"></td></td><td id ="t77"></td><td id ="t78"></td><td id ="t79"></td></tr>
            <tr><td id ="t81"></td><td id ="t82"></td><td id ="t83"></td><td class="spacer" style="width: 1px;"></td><td id ="t84"></td><td id ="t85"></td><td id ="t86"><td class="spacer" style="width: 1px;"></td></td><td id ="t87"></td><td id ="t88"></td><td id ="t89"></td></tr>
            <tr><td id ="t91"></td><td id ="t92"></td><td id ="t93"></td><td class="spacer" style="width: 1px;"></td><td id ="t94"></td><td id ="t95"></td><td id ="t96"><td class="spacer" style="width: 1px;"></td></td><td id ="t97"></td><td id ="t98"></td><td id ="t99"></td></tr>
        </table>
        <br>
        <table id="SelTable">
            <tr><th id="Hclr"><svg height="20" width="20">
                <polyline points="15,9 11,5 4,12 8,16 8,19 15,12 15,9 8,16" style="fill:rgb(181, 198, 205);stroke:black;stroke-width:1" />
                <polyline points="4,12 2,15 2,17 4,19 6,19 8,19" style="fill:rgb(255, 174, 176);stroke:black;stroke-width:1" />
              </svg></th>
                <th id="h1">1</th><th id="h2">2</th><th id="h3">3</th><th id="h4">4</th><th id="h5">5</th><th id="h6">6</th><th id="h7">7</th><th id="h8">8</th><th id="h9">9</th></tr>
            <tr><td class="spacer" colspan="10" style="height: 1px;"></td></tr>
            <tr><th id="ClearTable" colspan="2">Clear</th><th id="Run" colspan="2">Solve</th></tr>
        </table>
    </body>
    <script defer>
        //let count=0;
        let ArrData=[];
        let ArrTable=[];
        let ArrSelect=[];
        let wrongObj="";
        let correctObj="";
        let activeObj="";
        document.getElementById("Hclr").addEventListener("click",()=>
        {
            const ObjSel = document.getElementsByClassName('active');
            if(ObjSel.length)
            {
                if(wrongObj!="")document.getElementById(wrongObj).classList.remove('wrong');
                if(correctObj!="")document.getElementById(correctObj).classList.remove('correct');
                ObjSel[0].innerText="";
            }
        });
        document.getElementById("ClearTable").addEventListener("click",()=>
        {
            if(activeObj!="")document.getElementById(activeObj).classList.remove('active');
            if(wrongObj!="")document.getElementById(wrongObj).classList.remove('wrong');
            if(correctObj!="")document.getElementById(correctObj).classList.remove('correct');
            ArrTable.flat().forEach(Cell => {Cell.innerText="";Cell.style.color="rgb(27, 92, 213)";});
        });
        document.getElementById("Run").addEventListener("click",()=>
        {
            ArrData = GetTableData();
            solve_sudoku();
            //console.log(`count : ${count}`)
        });
        function findZero()
        {
            for(let R=0;R<9;R++)
            {
                for(let C=0;C<9;C++)
                {
                    if(ArrData[R][C]==0)return [R,C];
                }
            }
            return null;
        }
        function solve_sudoku()
        {
            //count++;
            let empty = findZero();
            if(empty==null)return true;
            for(let Num=1;Num<=9;Num++)
            {
                if(Check(ArrData,empty[0],empty[1],Num))
                {
                    let ID = "t"+(empty[0]+1)+(empty[1]+1);
                    document.getElementById(ID).innerText = Num.toString();
                    document.getElementById(ID).style.color="black"
                    ArrData[empty[0]][empty[1]] = Num;
                    if(solve_sudoku())return true;
                    ArrData[empty[0]][empty[1]] = 0;
                    document.getElementById(ID).innerText = "";
                }
            }
            return false;
        }
        for(let y=0;y<9;y++)
        {
            let ArrTemp=[];
            for(let x=0;x<9;x++)
            {
                let IdName="t"+(y+1).toString()+(x+1).toString();
                ArrTemp.push(document.getElementById(IdName));
            }
            ArrTable.push(ArrTemp);
        }
        
        for(let x=1;x<=9;x++)
        {
            let IdName="h"+x.toString();
            ArrSelect.push(document.getElementById(IdName));
        }

        function HandleClick(Obj)
        {
            if(activeObj!="")document.getElementById(activeObj).classList.remove('active');
            //ArrTable.flat().forEach(Cell => Cell.classList.remove('active'));
            let Cell = Obj.target;
            activeObj=Cell.id;
            Cell.classList.add('active');
        }
        ArrTable.flat().forEach(cell => {
            cell.addEventListener('click',HandleClick);
        });
        function Check(Table,Row,Col,Num)
        {
            const SqR=Math.floor(Row/3)*3;
            const SqC=Math.floor(Col/3)*3;
            let Y=0;
            if(Table[Row].includes(Num))return false;
            for(let i=0;i<=8;i++)
            {
                if((Table[i][Col])==Num)return false;
                if((Table[SqR+Y][SqC+(i%3)])==Num)return false;
                if((i%3)==2)Y++;
            }
            return true;
        }
        function SelectNum(Obj)
        {
            const ObjSel = document.getElementsByClassName('active'); 
            if(ObjSel.length)
            {
                if(wrongObj!="")document.getElementById(wrongObj).classList.remove('wrong');
                if(correctObj!="")document.getElementById(correctObj).classList.remove('correct');
                const Cell = Obj.target;
                const Num =parseInt(Cell.innerText);
                const IdName = ObjSel[0].id;
                const Row = parseInt(IdName[1])-1;
                const Col = parseInt(IdName[2])-1;
                ArrData=GetTableData();
                if(ObjSel[0].innerText!=Num)
                {
                    if(Check(ArrData,Row,Col,Num))
                    {
                        ObjSel[0].classList.add('correct');
                        correctObj=IdName;
                        ObjSel[0].innerText=Num;
                        wrongObj="";
                    }
                    else
                    {
                        ObjSel[0].classList.add('wrong');
                        wrongObj=IdName;
                        ObjSel[0].innerText="";
                        correctObj="";
                    }
                }
            }
        }
        ArrSelect.forEach(cell => {
            cell.addEventListener('click',SelectNum);
        });

        function GetTableData()
        {
            let ArrData_f=[];
            const table = document.getElementById('SuTable');
            const rows = table.getElementsByTagName('tr');
            for (let i = 0; i < rows.length; i++) 
            {
                const cells = rows[i].getElementsByTagName('td');
                if(cells.length==1)continue;
                const rowArray = [];
                for (let j = 0; j < cells.length; j++)
                {
                    if (cells[j].classList.contains('spacer'))continue;
                    let cell=cells[j].innerText;
                    if(cell=="")cell=0;
                    rowArray.push(parseInt(cell));
                }
                ArrData_f.push(rowArray);
            }
            return ArrData_f;
        }
        /*const in0 =[0,7,0,9,0,4,5,0,1,
                    0,0,0,0,0,7,6,0,0,
                    0,0,0,6,1,3,0,0,7,
                    0,5,7,0,0,2,0,9,6,
                    3,0,6,7,0,5,2,0,0,
                    0,8,0,1,9,0,7,0,0,
                    0,1,0,0,0,0,0,6,2,
                    9,2,8,5,0,1,0,0,4,
                    0,6,0,4,0,0,0,8,5]*/
        /*const in0 =[0,6,8,0,2,0,0,1,3,
                    3,4,2,9,0,0,6,0,0,
                    1,9,0,6,0,3,0,0,0,
                    4,0,0,0,5,0,8,9,1,
                    0,2,0,0,0,0,3,4,0,
                    0,5,0,3,0,0,0,0,0,
                    7,0,4,5,0,0,0,6,0,
                    6,0,5,1,0,0,4,0,9,
                    0,1,0,0,0,4,5,3,8]*/
        /*const in0 =[5,0,0,0,0,0,0,7,0,
                    0,0,7,9,0,8,0,6,0,
                    0,0,2,0,0,0,0,0,0,
                    0,0,5,2,4,0,9,0,3,
                    0,0,3,0,9,5,0,8,7,
                    0,0,1,0,0,0,2,0,0,
                    6,0,0,7,0,0,3,4,0,
                    3,7,0,0,2,0,0,9,0,
                    1,0,8,0,0,0,0,2,0,]*/
        /*const in0 =[0,0,0,8,0,9,0,4,0,
                    0,6,0,0,0,0,0,0,0,
                    8,2,0,5,0,0,0,0,9,
                    0,0,4,7,0,0,0,0,0,
                    7,8,0,0,2,0,0,1,0,
                    0,0,6,0,0,0,0,0,8,
                    0,0,0,0,1,0,3,0,0,
                    5,9,0,2,0,0,0,0,4,
                    0,0,7,0,0,0,0,0,0,]*/
        /*const in0 =[0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,
                    0,0,0,0,0,0,0,0,0,]*/
        //let in1 = [...in0]
    </script>
</html>
